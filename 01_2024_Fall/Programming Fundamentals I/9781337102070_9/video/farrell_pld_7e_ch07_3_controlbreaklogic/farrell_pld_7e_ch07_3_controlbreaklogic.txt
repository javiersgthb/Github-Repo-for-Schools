

 
    
  
>> Hi, this is Joyce Farrell. 

    Let's look at control break logic. 

    Here's a typical data file of company clients. 

    The file contains the last name and the state 

    of residence of each client. 

    A real data file might have many more fields, but this is enough 

    for us to understand a control break report. 

    So all the Alabama residents come first, then North Carolina, 

    then South Carolina, and finally all the residents in Tennessee. 

    Here's a report that you might want 

    to create from this data file. 

    It has a heading, company clients, 

    and then it lists all the clients in Alabama. 

    Then there's a count for the number of Alabama residents. 

    Then it lists the residents from North Carolina and a count, 

    the two from South Carolina and their count, 

    and finally the last 3 from Tennessee and their count. 

    Here's the mainline logic for this program. 

    You would start the program and then make some declarations. 

    There's a spot in memory for the input file 

    that holds the clients' names and states. 

    There's a title for the top of the report, that's a constant 

    that holds Company Clients. 

    And there's room for a name and a state for each client. 

    Account, which is initialized to zero, 

    and a string called oldState, which will be used 

    to hold the state that we're currently working 

    on to compare it to a new state to see 

    if it's time for a control break. 

    After the declarations have been made, 

    it's time to perform the getReady() module. 

    In the getReady() module, the first thing you do is output the 

    title, Company Clients, onto the report. 

    Then you can open the input files, 

    so they're all the clients' names and states are available. 

    When you input the name and the state from the input file, 

    the first record, Walters in Alabama, goes into memory. 

    Then you set oldState to the current state. 

    So, at the beginning of the program, state 

    and oldState are both Alabama. 

    You return from the getReady() module and go back 

    to the mainline logic, where you check for end of file. 

    It's not end of file because we've only read just the first 

    record into memory, so you can go 

    to the produceReport() module. 

    Within the  produceReport() module, 

    the first thing you do is compare the current state 

    to the old state. 

    The state in memory for the current record is Alabama, 

    and the old state is Alabama, because we just set them equal 

    at the end of the getReady() module. 

    So, it's not time to do a control break report. 

    State and oldState are equal, so you output the name 

    and the state from memory onto the report. 

    That's Walters and Alabama. 

    Then you add 1 to count, so count becomes 1, 

    and you've produced 1 record. 

    You can then input the next name and state from the input file. 

    In this case, they're Harris and Alabama. 

    When you exit the  produceReport() module and return 

    to the mainline logic, it's still not end of file, 

    so you go back to the produceReport() module. 

    There you compare state to oldState. 

    The new state for Harris is Alabama, 

    and the oldState was Alabama, so they are equal, 

    and you simply output Harris and Alabama. 

    You add 1 to count, so count becomes 2, 

    because you've produced 2 records, 

    and you get the next name and state from the input file. 

    In this case, they're Parker and Alabama. 

    You'll leave the produceReport() module, go back to mainline, 

    check for end of file. 

    You're not at end of file yet, 

    so you can go back to produceReport(). 

    In the produceReport() module, you compare state and oldState. 

    They're both Alabama, so you output Parker 

    and Alabama onto the report. 

    Count becomes 3, and you get the next record from the input file. 

    The next record happens to hold Jenkins 

    from North Carolina. 

    You return from the produceReport() module, check for end 

    of file, and go back to the produceReport() module. 

    Now in the pproduceReport() module, when you compare state 

    to oldState, they are not equal. 

    It's true that they are not equal. 

    The current state is North Carolina, 

    but the oldState is Alabama, 

    so it's time to perform the control break module. 

    In the control break module, you output the count 4 Alabama; 

    the oldState is 3. 

    It's important to use oldState because that's the one 

    for which you're producing the count. 

    Then because the new state is going to be North Carolina, 

    you set the count to zero, so it's ready for the new state. 

    Finally, you set oldState to state. 

    So oldState becomes North Carolina. 

    OldState is the control break field that you now set equal 

    to the current state that you're working on. 

    When you return from the controlBrake() module, 

    you go back to the produceReport() module 

    where you can now output the name and the state for Jenkins. 

    Jenkins has been waiting in memory, while the count 

    for Alabama was produced, and the count reset to zero, 

    and the old state set to state. 

    So now it's Jerkin's time to be output. 

    You then add 1 to count. 

    There's 1 record for the new state, 

    and you input the next name and state from the input file. 

    These happen to be Louis and South Carolina. 

    You return from produceReport(), go back to the mainline logic, 

    check for end of file, and go back to produceReport() again. 

    When you get back into produceReport(), you compare state 

    to old state. 

    They're different again, state is South Carolina 

    and oldState is North Carolina. 

    So, it's time for another control break. 

    In the controlBreak() module, you output the count 

    for the old state. 

    The count for North Carolina in just 1. 

    Then count is set to zero for the new state, 

    and oldState is updated to be equal to South Carolina. 

    You then can return from the controlBreak() module. 

    If you continued on you'd output all the records 

    for South Carolina, and then you'd output their count, 

    and then you would output all the records for Tennessee. 

    And as you continued reading records from Tennessee, 

    at one point you'd go to input the next name and state, 

    and you would reach the end of file. 

    You would not yet have produced the count for Tennessee, 

    because you would not know you were going 

    to reach the last record. 

    So, you would return from the produceReport() module, 

    go back to the mainline logic, and this time it is end of file, 

    so you can call the finishUp() module. 

    In the finishUp() module you'd output the count 

    for the last state, Tennessee. 

    In this case, it's count 3. 

    And then you can close the input file and return 

    from the finishUp() module. 

    Back in the mainline logic you stop the program. 

    And you've successfully produced the control break report. 

    Thanks for watching. 

   
